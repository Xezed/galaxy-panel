var angularModules=function(){var e=["ngSanitize","once","angularFileUpload","ngTouch","ngOptionsDisabled","ngRaven","netangels.ws","netangels.redirectors"];return typeof extendedAngularModules!="undefined"&&angular.isArray(extendedAngularModules)?e.concat(extendedAngularModules):e}(),extendedConfig=function(){return typeof extendedConfigArray!="undefined"&&angular.isArray(extendedConfigArray)?extendedConfigArray:[angular.noop]}();angular.module("netangelsApp",angularModules).config(["$httpProvider","wsProvider",function(e,t){e.defaults.xsrfCookieName="csrftoken",e.defaults.xsrfHeaderName="X-CSRFToken",e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",e.defaults.withCredentials=!0;var n=angular.extend({panelType:"user"},window.WS_CONFIG);t.configure(n)}]).config(extendedConfig).run();

angular.module("netangelsApp").controller("np__menuController",["$scope","$http","$rootElement","$attrs","$window","$swipe","Modal","Storage","Menu","menuConstants",function(e,t,n,r,i,s,o,u,a,f){var l=u.get("isSubmenuOpen"),c={},h=angular.element(i);e.showMenu=!1,e.isShowLeftMenu=!1,e.isSubmenuOpen=l!==undefined?l:!0,e.menuHeight=window.innerHeight-f.logoHeight,e.renderSubmenu=function(t,n){e.currentMenuItem!==n?n.children.length===0?window.location=n.href:(e.currentMenuItem=angular.extend(n,{_element:t.currentTarget}),$(".slideThisContent").perfectScrollbar("update")):e.currentMenuItem=!1},e.getHeaderMenu=function(e){return e+"HeaderMenu"},e.toggleHeaderMenu=function(t){e.showMenu==t?e.showMenu=!1:e.showMenu=t},e.cancelHeaderMenu=function(){e.showMenu=!1},e.cancelMenu=function(){e.currentMenuItem=!1,e.isShowLeftMenu=!1},e.$on("Table:runAction",function(){e.cancelMenu(),e.cancelHeaderMenu()}),e.isSubmenuClosed=function(){return e.isSubmenuOpen?!e.isShowAllMenu&&(!e.currentMenuItem||e.currentMenuItem.children.length===0)?!0:!1:!0},e.backStep=function(){e.currentMenuItem=!1},e.mobileMenuText=function(){if(e.currentMenuItem)return e.currentMenuItem.name};var p=angular.element(".slideThisContent"),d=function(t,n){return function(){var r=e[n];if(r&&angular.isDefined(r._element)){var i=r._element,s=i.getBoundingClientRect(),o=s.top,u=t.innerHeight();o+u>window.innerHeight&&(o=window.innerHeight-u),o<f.logoHeight&&(o=f.logoHeight),t.css({top:o})}}};p.on("perfect-scrollbar:change-size-and-position",d(angular.element(".np__secondMenu"),"currentMenuItem")),e.$on("onSubmenuCalculate",d(angular.element(".np__secondMenu"),"currentMenuItem")),e.$on("ngRepeatFinished",function(t,n){var r=n.element;angular.isDefined(r)&&$.inArray(r.attr("finish-render-name"),["submenu"])!==-1&&e.$emit("onSubmenuCalculate")}),e.initializeMenu=function(){e.headerMenu=a.headerMenu.getItems(),e.menu=a.getItems(),angular.isArray(e.menu)&&angular.forEach(e.menu,function(e,t){var n=e.children,r=e.mark;n.length>0&&r.length>0&&(c[r]=n)})},e.$on("netangelsMenuChanged",function(){e.initializeMenu()}),e.addScroll=function(){p.perfectScrollbar({suppressScrollX:!0,minScrollbarLength:45,wheelPropagation:!0,wheelSpeed:25})},e.subMenuHeight=function(){if(e.isShowLeftMenu)return e.menuHeight},h.on("resize",function(){e.menuHeight=window.innerHeight-f.logoHeight,window.innerWidth>960&&e.isShowLeftMenu&&(e.isShowLeftMenu=!1)}),e.$watch("menuHeight",function(){$(".slideThisContent").perfectScrollbar("update")}),e.initializeMenu(),e.addScroll()}]),angular.module("netangelsApp").constant("menuConstants",{logoHeight:97}),angular.module("netangelsApp").controller("NetangelsHeader",["$scope","$rootScope","$location",function(e,t,n){function r(e){e.hasOwnProperty("link")&&n.path(e.link)}e.breadcrumbs=[],e.currentIndex=-1,e.hasBreadcrumbs=function(){return e.breadcrumbs.length>0},e.getBreadcrumbClass=function(e){return e.current===!0?"np__big":"np__min"},e.GoTo=function(e){r(e)},e.hasBackButton=function(){return e.currentIndex>0},e.GoToBack=function(){r(e.breadcrumbs[e.currentIndex-1])},e.getBreadcrumbTitle=function(e){return e.title},t.$on("Header:ChangeBreadcrumbs",function(t,n){var r=n.breadcrumbs;if(angular.isArray(r)){e.breadcrumbs=r;for(var i=0;i<e.breadcrumbs.length;i++){var s=e.breadcrumbs[i];s.current===!0&&(e.currentIndex=i)}}})}]);

angular.module("netangels.telephony",[]),angular.module("netangels.telephony.call_lists",[]),angular.module("netangels.redirectors",[]);

angular.module("netangelsApp").filter("startFrom",function(){return function(e,t){return e.slice(+t)}}),angular.module("netangelsApp").filter("range",function(){return function(e){var t=[];e=parseInt(e,radix=10);for(var n=0;n<e;n++)t.push(n);return t}}),angular.module("netangelsApp").filter("capitalize",function(){return function(e){return e.charAt(0).toUpperCase()+e.slice(1)}});

angular.module("netangelsApp").constant("IntroTour",{options:{showStepNumbers:!1,exitOnOverlayClick:!0,disableInteraction:!0,exitOnEsc:!0,tooltipPosition:"auto",scrollToElement:!0,showProgress:!1,showBullets:!1,nextLabel:"\u0414\u0430\u043b\u044c\u0448\u0435",prevLabel:"\u041d\u0430\u0437\u0430\u0434",skipLabel:"\u041f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0442\u0443\u0440",doneLabel:'<div class="greenEnd">\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c</div>'},label:'<div class="labelTour" ng-click="startTour()">\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0442\u0443\u0440<div></div></div>',mainPage:[{element:".np__leftMenu",intro:'\u0412 \u044d\u0442\u043e\u043c \u043c\u0435\u043d\u044e \u0431\u0443\u0434\u0443\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c\u0438 \u0443\u0441\u043b\u0443\u0433\u0430\u043c\u0438. \u0412 \u0441\u0430\u043c\u043e\u043c \u043d\u0438\u0437\u0443 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0440\u0430\u0437\u0434\u0435\u043b \u0437\u0430\u043a\u0430\u0437\u0430 \u0443\u0441\u043b\u0443\u0433 (\u0438\u043a\u043e\u043d\u043a\u0430 \u0441 "\u043f\u043b\u044e\u0441\u043e\u043c")'},{element:".widgetsContainer",intro:'\u0420\u0430\u0437\u0434\u0435\u043b \u0432\u0438\u0434\u0436\u0435\u0442\u043e\u0432, \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u043f\u0430\u043d\u0435\u043b\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043e\u0431\u0449\u0443\u044e  \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e  \u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430. \u041c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u0438 \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0432\u0438\u0434\u0436\u0435\u0442\u044b \u043f\u043e \u0441\u0432\u043e\u0435\u043c\u0443 \u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u0438\u044e.  \u041c\u0435\u043d\u044f\u0442\u044c \u0432\u0438\u0434\u0436\u0435\u0442\u044b \u043c\u0435\u0441\u0442\u0430\u043c\u0438 \u043c\u043e\u0436\u043d\u043e "\u0437\u0430\u0445\u0432\u0430\u0442\u0438\u0432" \u0432\u0438\u0434\u0436\u0435\u0442 \u043c\u044b\u0448\u043a\u043e\u0439 \u0437\u0430 \u043b\u0435\u0432\u044b\u0439 \u0432\u0435\u0440\u0445\u043d\u0438\u0439 \u0443\u0433\u043e\u043b'},{element:".np__class_finance",intro:"\u0424\u0438\u043d\u0430\u043d\u0441\u043e\u0432\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0432\u0430\u0448\u0435\u0433\u043e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430. \u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u043c\u043e\u0436\u043d\u043e \u0442\u0430\u043a \u0436\u0435 \u043f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0431\u0430\u043b\u0430\u043d\u0441 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"},{element:".np__class_account",intro:'\u041c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a \u0432\u0430\u0448\u0435\u0433\u043e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 - \u043e\u0442 \u0421\u041c\u0421 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u0434\u043e \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0445 e-mail \u0430\u0434\u0440\u0435\u0441\u043e\u0432 (\u0440\u0430\u0437\u0434\u0435\u043b "\u0423\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435")'},{element:".np__class_support",intro:"\u0415\u0441\u043b\u0438 \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0438 \u0432\u043e\u043f\u0440\u043e\u0441\u044b, \u0442\u043e \u0432\u0441\u0435\u0433\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u0441\u0432\u044f\u0437\u0430\u0442\u044c\u0441\u044f \u0441 \u043d\u0430\u0448\u0435\u0439 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 \u0438\u043b\u0438 \u0444\u0438\u043d\u0430\u043d\u0441\u043e\u0432\u043e\u0439 \u0441\u043b\u0443\u0436\u0431\u043e\u0439. \u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0442\u0430\u043a \u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443 \u043d\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u0434\u043e\u043c\u0435\u043d\u0430"}]});

angular.module("netangelsApp").service("DirectiveUtils",["$parse",function(e){return{parse:function(t,n){try{if(t===undefined)return n;var r=e(t)();return r!==undefined?r:t}catch(i){return t}}}}]),angular.module("netangelsApp").service("Storage",function(){var e="localStorage"in window&&window.localStorage!==null;return{get:function(t){var n;if(e)try{n=window.localStorage.getItem(t),n=n===null?undefined:n}catch(r){}return n||(n=angular.element.cookie(t)),angular.fromJson(n)},set:function(t,n){if(e)try{window.localStorage.setItem(t,angular.toJson(n));return}catch(r){}angular.element.cookie(t,angular.toJson(n),{expires:7,path:"/"})},remove:function(t){if(e)try{window.localStorage.removeItem(t);return}catch(n){}else angular.element.removeCookie(t)}}}),angular.module("netangelsApp").service("NetangelsUtils",function(){return{number_format:function(e,t,n,r){var i=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):0,o=typeof r=="undefined"?",":r,u=typeof n=="undefined"?".":n,a="",f=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return a=(s?f(i,s):""+Math.round(i)).split("."),a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(a[1]||"").length<s&&(a[1]=a[1]||"",a[1]+=(new Array(s-a[1].length+1)).join("0")),a.join(u)},money_format:function(e){return this.number_format(e,2,",","&nbsp;")}}}),angular.module("netangelsApp").constant("ActionNames",{add:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",edit:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",comment:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",on:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c",off:"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c","delete":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"});

angular.module("netangelsApp").factory("Modal",["$compile","$rootScope","$sce","$http","$timeout","Messages",function(e,t,n,r,i,s){var o={actionUrl:"",method:"post",template:null,title:"",type:"form",formType:"form",formEnctype:"application/x-www-form-urlencoded",extraData:null,formAttrs:null,jsValidators:undefined,redirectUrl:undefined,description:"",submitButtonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",cancelButtonName:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",wrapperClass:"",formController:undefined,current:undefined,callbacks:{},closeOnAction:!0,submitButtonShow:!0,hideCloseButton:!1,htmlButtonsShow:!1},u=angular.element("body");return function a(r,i){r=r||{},r=angular.extend({},o,r);var f=this,l=angular.element("<netangels-modal></netangels-modal>"),c=i||t.$new(),h=["input","select","textarea","netangels-interactive-field"];r.formController&&l.attr("form-controller",r.formController),c.method=r.method,c.actionUrl=r.actionUrl,c.template=n.trustAsHtml(r.template),c.title=r.title,c.type=r.type,c.formType=r.formType,c.description=n.trustAsHtml(r.description),c.submitButtonName=r.submitButtonName||o.submitButtonName,c.cancelButtonName=r.cancelButtonName||o.cancelButtonName,c.wrapperClass=r.wrapperClass,c.enctype=r.enctype||"application/x-www-form-urlencoded",c.formClass=r.formClass,c.formController=r.formController,c.callbacks=r.callbacks,c.hideCloseButton=r.hideCloseButton||o.hideCloseButton,c.htmlButtonsShow=r.htmlButtonsShow||o.htmlButtonsShow,c.submitButtonShow=o.submitButtonShow,typeof r.submitButtonShow!="undefined"&&(c.submitButtonShow=r.submitButtonShow),c.$on("modalGetData",function(e){var t=e.targetScope;t.extraData=r.extraData,t.current=r.current,t.jsValidators=r.jsValidators,t.redirectUrl=r.redirectUrl,t.fa=r.formAttrs,t.onSuccess=function(e,n,i,s){r.closeOnAction&&c.closeModal(),angular.isFunction(c.callbacks.onAction)&&(angular.isArray(e)?angular.forEach(e,function(e){c.callbacks.onAction(c,l,e)}):c.callbacks.onAction(c,l,e)),t.defaultOnSuccess(e,n,i,s)},t.onError=function(e,n,i,o){n===400?e.form_object&&e.form_object.update_form?(t.closeModal(),r.template=e.form_object.html,r.description=e.form_object.description,r=$.extend(r,e.form_object.options),new a(r)):t._errors=e.errors:n===500?s.callErrorMessage("internalError",e.error_message):n==409?s.callErrorMessage("conflict",e.error_message):s.callErrorMessage("unknown",e.error_message),t.isActionProgress=!1}}),angular.element("<span />").html(r.template).find(h.join(", ")).length===0&&(c.formType="formMessage");var p=function(e){e.keyCode===27&&c.$apply(function(){c.closeModal()})};return c.submitModal=function(){if(angular.isFunction(c.callbacks.onSubmit)&&c.callbacks.onSubmit(c,l)===!1)return;c.closeModal()},c.closeModal=function(){angular.isFunction(c.callbacks.onClose)&&c.callbacks.onClose(c,l),u.off("keydown",p),c.$broadcast("modalDestroy"),t.$broadcast("root:modalDestroy"),l.remove()},u.on("keydown",p),compiled=e(l)(c),u.append(compiled),{closeModal:c.closeModal}}}]);

angular.module("netangelsApp").service("Menu",["$rootScope","$http",function(e,t){function n(e,t){this.url=e,this.items=t||[]}return n.prototype.getItems=function(e){var t=this.items;return angular.isDefined(e)?t.filter(function(t){return t.mark==e})[0]:t},n.prototype.setItems=function(t){this.items=[];for(var n=0;n<t.length;++n)this.items.push(t[n]);return e.$broadcast("netangelsMenuChanged",this),this},n.prototype.fetch=function(){return t({url:this.url,method:"GET",params:{_:(new Date).getTime()}}).success($.proxy(function(e,t,n,r){this.setItems(e)},this))},{userMenu:new n("/menu_items/",NETANGELS_MENU),headerMenu:new n("/header_menu_items/",NETANGELS_HEADER_MENU),fetch:function(){this.userMenu.fetch()},getItems:function(e){return this.userMenu.getItems(e)}}}]);

angular.module("netangelsApp").service("Validator",function(){var e={checkable:function(e){return/radio|checkbox/i.test(e.type)},getLength:function(t,n){switch(n.nodeName.toLowerCase()){case"select":return $("option:selected",n).length;case"input":if(e.checkable(n))return this.findByName(n.name).filter(":checked").length}return t.length}},t={required:function(t,n){switch(n.nodeName.toLowerCase()){case"select":var r=$(n).val();return r&&r.length>0;case"input":if(e.checkable(n))return e.getLength(t,n)>0;default:return $.trim(t).length>0}},email:function(e,t){return!this.required(e,t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e)},url:function(e,t){return!this.required(e,t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return!this.required(e,t)||!/Invalid|NaN/.test(new Date(e))},dateISO:function(e,t){return!this.required(e,t)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},number:function(e,t){return!this.required(e,t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},digits:function(e,t){return!this.required(e,t)||/^\d+$/.test(e)},domainRequired:function(e,t){return!this.required(e,t)||/^[\w\-\.\u0430-\u044f\u0410-\u042f\u0451]+\.[\u0430-\u044f\u0410-\u042f\u0451\w\-]{2,64}$/.test(e)},urlRequired:function(e,t){return!this.required(e,t)||/^(http|ftp|https)\:\/\/([\w\-\.\u0430-\u044f\u0410-\u042f\u0451]+)\.[\u0430-\u044f\u0410-\u042f\u0451\w\-]{2,8}\S*$/.test(e)},dotForbidden:function(e,t){return!this.required(e,t)||e.indexOf(".")===-1},preventCyrillic:function(e,t){return!this.required(e,t)||!/[\u0430-\u044f\u0410-\u042f\u0451]/.test(e)},zipcodeRequired:function(e,t){return!this.required(e,t)||/^\d{5,6}$/.test(e)},phoneRequired:function(e,t){var n=e.replace(/[^\d]/g,"");return!this.required(e,t)||!/^\d{0,4}$/.test(n)},faxValidate:function(e,t){var n=e.replace(/[^\d]/g,"");return!this.required(e,t)||!/^\d{0,4}$/.test(n)},passportRequired:function(e,t){return this.required(e,t)?$("[name=resident]:checked").val()==="True"?/^\d{10}$/.test(e.replace(/ /g,"")):!0:!1},codeRequired:function(e,t){return!this.required(e,t)||/^\d{10,12}$/.test(e)},kppRequired:function(e,t){return!this.required(e,t)||/^\d{9}$/.test(e)},ogrnRequired:function(e,t){return!this.required(e,t)||/^\d{13}$/.test(e)}},n={required:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435.",email:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u0442\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b.",url:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 URL.",date:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0443\u044e \u0434\u0430\u0442\u0443.",dateISO:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0443\u044e \u0434\u0430\u0442\u0443 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 ISO.",number:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e.",digits:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u043e\u0434\u0438\u0442\u0435 \u0446\u0435\u043b\u043e\u0435 \u0447\u0438\u0441\u043b\u043e.",domainRequired:"\u0423\u043a\u0430\u0437\u0430\u043d\u043e \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0435 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0435 \u0438\u043c\u044f",urlRequired:"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 URL",dotForbidden:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u0447\u043a\u0443"
,preventCyrillic:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0443 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b",zipcodeRequired:"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0438\u043d\u0434\u0435\u043a\u0441",phoneRequired:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430. \u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u044c\u0448\u0435 5 \u0446\u0438\u0444\u0440",faxValidate:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0444\u0430\u043a\u0441\u0430. \u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u044c\u0448\u0435 5 \u0446\u0438\u0444\u0440",passportRequired:"\u041d\u043e\u043c\u0435\u0440 \u043f\u0430\u0441\u043f\u043e\u0440\u0442\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0438\u0437 10 \u0446\u0438\u0444\u0440",codeRequired:"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0418\u041d\u041d, \u0418\u041d\u041d \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0438\u0437 10 \u0446\u0438\u0444\u0440 \u0434\u043b\u044f \u042e\u0440\u0438\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043b\u0438\u0446 \u0438 \u0438\u0437 12 \u0434\u043b\u044f \u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u0435\u0439",kppRequired:"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u041a\u041f\u041f, \u041a\u041f\u041f \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0438\u0437 9 \u0446\u0438\u0444\u0440",ogrnRequired:"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u041e\u0413\u0420\u041d, \u041e\u0413\u0420\u041d \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0438\u0437 13 \u0446\u0438\u0444\u0440"};return{validate:function(e,r){var i={};for(var s in r){var o=e.find("[name={0}]".replace("{0}",s)).not(":hidden");if(o.length>0)for(var u in r[s]){if(r[s][u]===!1)continue;u in t&&t[u](o.val(),o[0])===!1&&(i[s]=n[u])}}return{isValid:angular.element.isEmptyObject(i),errors:i}},makeFormValidateChain:function(e,t){var n=e.closest("form");n&&angular.isFunction(n.scope)&&(angular.isArray(n.scope().extraValidateChain)||(n.scope().extraValidateChain=[]),n.scope().extraValidateChain.push(t))}}});

angular.module("netangelsApp").constant("MessagesConfig",{fetchUrl:"/messages/"}),angular.module("netangelsApp").service("Messages",["$rootScope","$http","$timeout","MessagesConfig",function(e,t,n,r){var i=[],s={level:"info",temporary:!1,message_type:"upper",duration:8};return{getMessages:function(e){return $.grep(i,function(t,n){return t.message_type===e})},fetch:function(){var e=this,n=r.fetchUrl;t.get(n).success(function(t,n,r,i){e.add(t)})},add:function(t,r){var o=function(t,r){angular.isUndefined(r)&&(r=t.temporary),r===!0&&n(function(){var n,r=this;angular.forEach(i,function(e,r){e===t&&(n=r)}),i.splice(n,1),e.$emit("onMessagesRemoved")},t.duration*1e3)};angular.isArray(t)?angular.forEach(t,function(e,t){i.push($.extend({},s,e)),o(e,r)}):(i.push($.extend({},s,t)),o(t,r)),e.$emit("onMessagesAdded")},remove:function(t){i.splice(t,1),e.$emit("onMessagesRemoved")},clear:function(){i=[],e.$emit("onMessagesRemoved")},defaultMessages:{internalError:{level:"error",text:"\u041f\u0440\u0438\u043d\u043e\u0441\u0438\u043c \u0441\u0432\u043e\u0438 \u0438\u0437\u0432\u0438\u043d\u0435\u043d\u0438\u044f. \u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0432\u0430\u0448\u0435\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043d\u0435\u0439 \u0443\u0436\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0430\u0448\u0438\u043c \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0430\u043c. \u041c\u044b \u043f\u0440\u0438\u043b\u043e\u0436\u0438\u043c \u0432\u0441\u0435 \u0443\u0441\u0438\u043b\u0438\u044f, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0435\u0451 \u0432 \u043a\u0440\u0430\u0442\u0447\u0430\u0439\u0448\u0438\u0435 \u0441\u0440\u043e\u043a\u0438."},conflict:{level:"error",text:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e. \u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430."},unknown:{level:"error",text:"\u041f\u0440\u0438\u043d\u043e\u0441\u0438\u043c \u0441\u0432\u043e\u0438 \u0438\u0437\u0432\u0438\u043d\u0435\u043d\u0438\u044f. \u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0432\u0430\u0448\u0435\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u043f\u043e\u0437\u0436\u0435 \u0438\u043b\u0438 \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u0432 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0443, \u0435\u0441\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0430 \u0432\u043e\u0437\u043d\u0438\u043a\u0430\u0435\u0442 \u0443\u0436\u0435 \u043d\u0435 \u0432 \u043f\u0435\u0440\u0432\u044b\u0439 \u0440\u0430\u0437."},adminInternalError:{level:"error",text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u043e\u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c \u0441 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c\u0438."}},callErrorMessage:function(e,t){var n=this,r=$.extend({temporary:!1,message_type:"upper",duration:8},n.defaultMessages[e]);$.extend(r,t),n.add(r)}}}]);

angular.module("netangelsApp").controller("NetangelsTableController",["$scope","$filter","$http","$q","ActionNames","Modal","Storage","Messages",function(e,t,n,r,i,s,o,u){e.selected=[],e.viewList=[],e.current=undefined,e.isActionRun=!1,e.toggleList=function(){e.selected.length!==e.viewList.length?angular.forEach(e.viewList,function(t,n){e.selected.indexOf(t.id)===-1&&e.selected.push(t.id)}):e.selected=[]},e.toggleItem=function(t){var n=e.selected.indexOf(t.id);e.selected.indexOf(t.id)===-1?e.selected.push(t.id):e.selected.splice(n,1)},e.isItemChecked=function(t){return e.selected.indexOf(t.id)!==-1},e.isAllItemChecked=function(t){return e.viewList.length&&e.selected.length===e.viewList.length?!0:!1},e.runGlobalAction=function(){e.selected=[]},e.sortItems=function(t){e.sortBy===t?e.sortReverse=!e.sortReverse:(e.sortReverse=!1,e.sortBy=t),o.set(window.location.pathname+"SortBy",e.sortBy),o.set(window.location.pathname+"SortReverse",e.sortReverse)},e.changePage=function(t){t>=0&&t<e.numberOfPages()&&(e.currentPage=t)},e.getToPage=function(){var t=e.currentPage*e.pageSize+e.pageSize;return t>e.filtered.length?e.filtered.length:t},e.numberOfPages=function(){return Math.ceil(e.filtered.length/e.pageSize)},e.getPageRange=function(){var t=[];for(var n=0;n<e.numberOfPages();n++)t.push(n);return t},e.isShowItemActions=!1,e.getActionName=function(t,n){return n&&e.actionTitles&&t in e.actionTitles?e.actionTitles[t](n):e.actions[t].name},e.runAction=function(t,r){if(e.isActionRun||!e.isActionAllowed(r,t))return;e.isActionRun=!0,e.isShowItemActions=!1,e.current=r;var o=e.actions[t],a;if(o.type==="action")angular.isFunction(e.actionLinks[t])&&e.actionLinks[t](r);else{a=o.url;if(r){var f=a.match(/\{\w+\}/g);if(f)for(var l=0;l<f.length;l++){var c=f[l].substr(1,f[l].length-2);a=a.replace(f[l],r[c])}}o.type==="link"?window.location=a:o.type==="link_target_blank"?window.open(a):n.get(a+"?form").success(function(n,r,u,f){var l=e.actions[t].titleSuffix||e.verboseName,c=e.getActionName(t,e.current)+" "+l;e.current&&t!=="add"&&(e.current.formTitleName?c+=" "+e.current.formTitleName:c+=" "+e.current[e.fieldForTitle]);var h=$.extend({type:o.type||"form",title:c,actionUrl:a,callbacks:e.callbacks[t]||{},wrapperClass:e.actions[t].wrapperClass||"",formController:e.actions[t].ctrl,redirectUrl:e.actions[t].redirectUrl,template:n.html,extraData:n.extra_data,enctype:e.actions[t].enctype,formAttrs:n.form_js_attrs,jsValidators:n.js_validators,current:e.current,description:n.description,submitButtonName:e.actions[t].submitName||i[t],closeOnAction:e.actions[t].closeOnAction===undefined?!0:e.actions[t].closeOnAction},n.options),p=new s(h)}).error(function(e,t,n,r){t===500?u.callErrorMessage("internalError",e.error_message):t==409?u.callErrorMessage("conflict",e.error_message):u.callErrorMessage("unknown",e.error_message)})}e.isActionRun=!1};var a=function(){angular.isObject(e.groupData)?e.filterGroup():e.baseFilter().then(function(t){e.filtered=t}),e.pages=e.getPageRange(),e.pages.length>0&&e.currentPage>e.pages[e.pages.length-1]&&(e.currentPage=e.pages[e.pages.length-1]),e.selected=[]};e.baseFilter=function(){var n=r.defer();return angular.isFunction(e.getFilter)?e.getFilter().then(function(e){n.resolve(e)}):n.resolve(t("filter")(e.instanceList,e.searchText)),n.promise},e.search=function(){e.currentPage=0,a()},e.$watch("instanceList",a),e.$watch("pageSize",function(){o.set(window.location.pathname+"PageSize",e.pageSize),a()}),e.$watch("isShowItemActions",function(){e.isShowItemActions==1&&e.$emit("ItemActionsShowed")}),e.toggleCurrent=function(t){t===e.current?e.current=undefined:(e.current=t,e.isShowItemActions=!1),e.$emit("toggleInstance")},e.addInstance=function(t,n){var r=-1;angular.isFunction(e.getItem)&&(t=e.getItem(t)),$.each(e.instanceList,function(e,n){if(n.id===t.id)return r=e,!1}),r!==-1?(n===undefined?e.instanceList[r]=t:(e.instanceList.splice(r,1),e.instanceList.splice(n,0,t)),e.$emit("tableInstanceUpdated",t)):(n===undefined?e.instanceList.push(t):e.instanceList.splice(n,0,t),e.$emit("tableInstanceAdded",t)),a()},e.removeInstance=function(t){$.each(e.instanceList,function(n,r){if(r.id===t.id){var i=e.instanceList.splice(n,1)[0];return e.current=null,e.$emit("tableInstanceRemoved",i),a(),!1}})},e.$on("tableLoaded",function(){e._defaultCallbacks={add:{onAction:function(t,n,r){e.addInstance(r)}},"delete":{onAction:function(t,n,r){e.removeInstance(r)}}},angular.forEach(e.actions,function(t,n){e.callbacks||(e.callbacks={}),e.callbacks[n]||(e.callbacks[n]={}),e.callbacks[n].onAction||(n in e._defaultCallbacks?e.callbacks[n].onAction=e._defaultCallbacks[n].onAction:t.type!=="link"&&t.type!=="action"&&(e.callbacks[n].onAction=function(t,n,r){e.addInstance(r)}))}),a(),e.isLoaded=!0}),e.filterGroup=function(){e.baseFilter().then(function(n){e.filtered=n;var r=e.groupData[e.currentGroup].filter;angular.isFunction(r)?e.filtered=t("filter")(e.filtered,r):r===null&&(e.filtered=e.filtered)})},e.isActionAllowed=function(t,n){return e.checkActions&&n in e.checkActions?e.checkActions[n](t):!0},e.isActionShow=function(t,n){return e.showActions&&n in e.showActions?e.showActions[n](t):!0},e.isEnabledAction=function(t,n){return e.disabledActions&&n in e.disabledActions?!e.disabledActions[n](t):!0},e.normalizeFieldValue=function(e,t){return e&&e.$$unwrapTrustedValue?e:angular.isUndefined(e)||e===null?"-":function(e){return t==1&&(e=NETANGELS.util.htmlspecialchars(e)),e}(e.toString())},e.isUntrustedFields=function(t,n){var r=e.untrustedFields.indexOf(n)!==-1;return r===!0?angular.isFunction(e.untrustedCondition)?e.untrustedCondition(t):!0:!1}}]);

angular.module("netangelsApp").controller("MessageController",["$scope","$rootScope","$http","$rootElement","Messages","Modal","ws",function(e,t,n,r,i,s,o){function u(){e.messages=i.getMessages("upper"),e.modalMessages=i.getMessages("modal")}i.fetch(),e.messages=[],e.modalMessages=[],e.modal={},t.$on("onMessagesAdded",u),t.$on("onMessagesRemoved",u),e.$watch("modalMessages",function(t,n){for(var r in n){var i=n[r];t.indexOf(i)===-1&&e.modal[i.hash].closeModal()}for(var r in t){var i=t[r];n.indexOf(i)===-1&&(e.modal[i.hash]=new s({type:"html",title:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",template:i.text}))}}),o(function(t){t.subscribe("messages",t.userChannel(),e).on("message",function(e){i.add(e)})}),e.removeMessage=function(e){i.remove(e)}}]);

angular.module("netangelsApp").controller("helpModalController",["$scope","$http","Modal",function(e,t,n){e.getSupportHelp=function(e){t.get("/help/",{params:{name:e},responseType:"text/html"}).success(function(e){modal=new n({title:"\u041f\u043e\u043c\u043e\u0449\u044c",template:e,type:"html"})})}}]);

angular.module("netangelsApp").controller("netangelsInteractiveController",["$scope","$element","$rootElement","$compile","$parse","$q","$timeout","$sce","Validator",function(e,t,n,r,i,s,o,u,a){function f(){var t=0;return{create:function(e,n,r){return t++,{id:t,value:punycode.toUnicode(e),template:n,isSended:r!=null?r:!0}},createFromValueList:function(e){var t=this,n=[];return angular.forEach(e,function(e){n.push(t.create(e))}),n},compile:function(t){if(t.template){var n=e.$new();n.entity=t,t.template=r(t.template)(n)}return t}}}var l=new f,c=[],h=t.closest("form");t.attr("initial")&&(c=t.attr("initial").replace(/[\n\r]/g," ").replace(/\s+/g," ")),e.delimiter=angular.isString(t.attr("delimiter"))?t.attr("delimiter"):" ",e.entityList=c!=null&&c.length>0?l.createFromValueList(c.split(e.delimiter)):[],e.initialEntityList=angular.copy(e.entityList),e.entityValue="",e.regexValidator=t.attr("regex-validator")!=null?new RegExp(t.attr("regex-validator"),"g"):null,e.inputName=t.attr("input-name"),e.inputId=t.attr("element-id"),e.checkUrl=t.attr("check-url"),e.description=u.trustAsHtml(t.attr("description")||""),e.editable=t.attr("editable"),e.required=t.attr("required")!=null,e.requiredOneInitial=t.attr("required-one-initial")!=null,e.currentEditId=null,e.editingValue=null,e.validate=function(t){var n=punycode.toASCII(t);return e.regexValidator!=null&&n.match(e.regexValidator)===null?(e.errors.push('\u0412\u0432\u0435\u0434\u0435\u043d\u043e \u043d\u0435\u0432\u0435\u0440\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435: <span class="redColor">'+t+"</span>"),!1):!0},e.isCanAddEntity=function(){return e.entityValue==""},e.isCanEdit=function(t){if(e.requiredOneInitial){var n=[];angular.forEach(e.initialEntityList,function(t){var r=e.getEntityByAttribute(t.value,"value");r&&n.push(r)});if(n.length<=1&&e.getEntityByAttribute(t,"value",e.initialEntityList)!=null)return!1}return!0},e.getEntityByAttribute=function(t,n,r){n=n||"id",r=r||e.entityList;var i=$.grep(r,function(e){return e[n]===t});return i.length>0?i[0]:null},e.getEntityIndexByAttribute=function(t,n,r){n=n||"id",r=r||e.entityList;for(var i in r){var s=r[i];if(t==s[n])return i}return-1},e.getResult=function(){return e.entityList.filter(function(e){return e.isSended==1}).map(function(e){return e.value}).join(" ")},e.removeEntity=function(t){var n=e.getEntityIndexByAttribute(t);e.entityList.splice(n,1)},e.addEntity=function(t){t=e.cleanValue(t),e.clearError(),e.entityValue!=""&&e.validate(t)&&(e.getEntityIndexByAttribute(t,"value")===-1?(e.entityList.push(l.create(t)),e.entityValue=""):e.errors.push("\u0422\u0430\u043a\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0443\u0436\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435"))},e.cleanValue=angular.isFunction(e.cleanValue)?e.cleanValue:function(e){return e},e.saveEditEntity=function(t,n){t=e.cleanValue(t),e.clearError(),e.validate(t)&&(e.entityList[e.getEntityIndexByAttribute(n)]=l.create(t),e.exitEditEntity())},e.editEntity=function(t){e.currentEditId=t,e.editingValue=e.getEntityByAttribute(t).value},e.exitEditEntity=function(){e.currentEditId=null,e.editingValue="",e.clearError()},e.clearError=function(){e.errors=[]},n.on("keydown",function(){event.keyCode==27&&e.exitEditEntity()}),e.isEditingEntity=function(t){return e.editable&&t===e.currentEditId};if(angular.isFunction(e.$parent.getAdditionalInteractive)){var p=e.$parent.getAdditionalInteractive({inputName:e.inputName});p!=null&&angular.forEach(p.entityValueList,function(t){var n=l.compile(l.create(e.cleanValue(t.value),t.template,t.isSended));e.entityList.push(n)})}e.$on("ngRepeatFinished",function(n,r){var s=t.find("[dynamic-entity-id]");s.length>0&&angular.forEach(s,function(t){var n=angular.element(t),r=angular.element(t).children("div"),s=i(n.attr("dynamic-entity-id"))();r.replaceWith(e.getEntityByAttribute(s).template)})}),angular.isFunction(e.getExtraTemplate)&&angular.forEach(e.entityList,function(t){t.extra=e.getExtraTemplate(t)}),a.makeFormValidateChain(t,function(){var t=!0,n=[],r={},i=s.defer();return e.clearError(),e.addEntity(e.entityValue),n=angular.copy(e.errors),e.clearError(),o(function(){n.length>0&&(t=!1,r[e.inputName]=n.join(" ")),i.resolve({isValid:t,errors:r})}),i.promise})}]);

angular.module("netangelsApp").controller("UserChangeWatchController",["$scope","$interval","Modal",function(e,t,n){e.userIdCookieName="user_id",e.currentUserId=$.cookie(e.userIdCookieName),e.$watch("currentUserId",function(r,i){i!=undefined&&r!=i?(e.currentUserId=r,new n({type:"form",formType:"form",title:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0441\u044f",template:"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u044b \u0437\u0430\u0448\u043b\u0438 \u0432 \u043f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u0434 \u0434\u0440\u0443\u0433\u0438\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c.",submitButtonShow:!0,submitButtonName:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443",redirectUrl:"/"})):t(function(){e.currentUserId=$.cookie(e.userIdCookieName)},1e3)})}]);

angular.module("netangelsApp").controller("IntroController",["$scope","$element","$compile","IntroTour",function(e,t,n,r){e.isLabel=t.data("isLabel")||!1;var i=t.data("steps")||[],s=r.options,o='<div class="buttonTour" ng-click="startTour()">\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0442\u0443\u0440</div>';s.steps=r[i],e.startTour=function(){var e=introJs();e.setOptions(s),e.start()},e.isLabel&&t.append(n(r.label)(e)),angular.element(".subMainContent").append(n(o)(e))}]);

angular.module("netangelsApp").directive("stopEvent",function(){return{restrict:"A",link:function(e,t,n){t.bind(n.stopEvent,function(e){e.stopPropagation()})}}}),angular.module("netangelsApp").directive("onFinishRender",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){t.$last===!0&&e(function(){t.$emit("ngRepeatFinished",{element:n})})}}}]),angular.module("netangelsApp").directive("compileTemplate",["$compile",function(e){return{link:function(t,n,r){var i=r.watchCompileVariable||"ngBindHtml";t.$watch(i,function(){t.$emit("compileTemplateComplete",n),"dynamicCompile"in r&&e(n,null,-9999)(t)})}}}]),angular.module("netangelsApp").directive("needCompile",["$compile","$timeout",function(e,t){return{link:function(n,r,i){t(function(){var t=r.contents(),i=e(t)(n);r.empty();var s=r.append("<div></div>");s.replaceWith(i)})}}}]);

angular.module("netangelsApp").directive("netangelsForm",["$compile","$timeout","$http","$rootElement","$rootScope","$q","Validator","Messages","DirectiveUtils",function(e,t,n,r,i,s,o,u,a){return{restrict:"A",scope:!0,link:function(f,l,c,h){var p,d=/(\{{2})\s+\w+\s+(\}{2})/g;f.redirectUrl=c.redirectUrl,f.reloadPage=c.reloadPage!=null,f.withoutHeaderErrors=a.parse(c.withoutHeaderErrors,!1),f.fieldsWithoutErrors=a.parse(c.fieldsWithoutErrors)||[],f.defaultSubmitEvent=function(e){f.$apply(function(){f.submit()}),e.preventDefault()};var v=angular.isFunction(f.submitEvent)?f.submitEvent:f.defaultSubmitEvent;l.on("submit",v);var m=function(){var t=angular.element("<div />").addClass("errors").attr("ng-show",'showError("__all__")').attr("ng-bind-html",'getError("__all__")');f.withoutHeaderErrors||l.prepend(t),l.find("button[type=submit]").attr("ng-disabled","isActionProgress").attr("ng-class","{isLoading: isLoading}"),angular.isFunction(f.formPrepareCompile)&&f.formPrepareCompile(l),y(l),e(t)(f)},g=function(e){var t=angular.element(e),n=t.closest("td, div"),r=t.attr("name"),i=null;return r.match(d)?null:(n.find("span.errors").length===0?(i=angular.element("<span />").addClass("errors").attr("ng-show",'showError("'+r+'")').attr("ng-bind-html",'getError("'+r+'")'),n.append(i)):i=n.find("span.errors").attr("ng-show",'showError("'+r+'")').attr("ng-bind-html",'getError("'+r+'")'),i)},y=function(t,n){var r=t.contents(),i=r.find("input, select, textarea").filter("[name]").not("[type=hidden]"),s=[];n=n==undefined?!1:n,angular.forEach(i,function(e,t){var n=angular.element(e).attr("name");if($.inArray(n,f.fieldsWithoutErrors)===-1){var r=g(e);r!==null&&s.push(r.get(0))}});if(n)t.attr("compile-error-only")!=null?e(s)(f):e(r)(f);else{var o=[];angular.forEach(r,function(e){var t=$(e).find("[compile-template]");t.length==0&&o.push(e)}),t.attr("compile-error-only")!=null?e(s)(f):e(o)(f)}};"dynamicContent"in c&&f.$on("compileTemplateComplete",function(e,n){var i=n.contents();i=i.add(r.find(".toolbar")),angular.isFunction(f.formInit)&&f.formInit(l),y(n,!0),t(function(){i.find("input[id$=password]").not(".noGen").genPasswd(),interfacePluginsModule.addChosen(i),interfacePluginsModule.addTooltipInput(i),interfacePluginsModule.addTooltipTitle(i),angular.isFunction(f.afterCompile)&&f.afterCompile(i)})}),"getModalData"in c&&f.$emit("modalGetData"),m(),f._errors={},f.isActionProgress=!1,f.isLoading=!1,f.jsValidators={},f.showError=function(e){return e in f._errors},f.getError=function(e){return e in f._errors?f._errors[e]:""},f.defaultOnSuccess=function(t,n,r,i){var s=t.redirect||f.redirectUrl,o=t.reloadPage||f.reloadPage;if(s)window.location.replace(s);else if(o)window.location.reload();else{f.isActionProgress=!1,f._errors={},u.fetch();if(t.replace_form&&t.form){var a=e(t.form.html)(f),c=angular.element("<div></div>");l.children(".wrapperForForm").empty().append(c),c.replaceWith(a),y(l)}}},f.defaultOnError=function(e,t,n,r){t===400?f._errors=e.errors:t===500?u.callErrorMessage("internalError",e.error_message):t===409?u.callErrorMessage("conflict"):u.callErrorMessage("unknown",e.error_message),f.isActionProgress=!1},f.onSuccess=f.onSuccess||f.defaultOnSuccess,f.onError=f.onError||f.defaultOnError,f.submit=function(e){function c(){var e=new FormData(l.get(0));angular.isFunction(f.changeFormData)&&f.changeFormData(e);if(u.isValid){a=t(function(){f.isLoading=!0},200);var s=function(e){f.isLoading?t(function(){e(),f.isLoading=!1,i.$broadcast("form:isLoadingFalse")},500):(t.cancel(a),e())};f.isActionProgress=!0,n.post(r,e,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(e,t,n,r){s(function(){f.onSuccess(e,t,n,r)})}).error(function(e,t,n,r){s(function(){f.onError(e,t,n,r)})})}else f._errors=angular.copy(u.errors)}var r=l.attr("action"),u,a;f.jsValidators?u=o.validate(l,f.jsValidators):u={isValid:!0,errors:{}},angular.isFunction(f.beforeRequest)&&f.beforeRequest();if(angular.isArray(f.extraValidateChain)){var h=$.map(f.extraValidateChain,function(e){return e()});s.all(h).then(function(e){angular.forEach(e,function(e){e.isValid==0&&(u.isValid=!1,u.errors=angular.extend(u.errors,e.errors))}),c()})}else c()}}}}]);

angular.module("netangelsApp").directive("chosen",["DirectiveUtils",function(e){return{restrict:"A",link:function(t,n,r){var i=e.parse(r.reset,!1),s=e.parse(r.width,"200px");t.$watch(r.chosen,function(){n.trigger("chosen:updated")}),t.$watch(r.ngModel,function(){n.trigger("chosen:updated")}),n.chosen({width:s,disable_search:!0}),n.on("change",function(e,t){i&&(n.val(""),n.trigger("chosen:updated"))})}}}]);

angular.module("netangelsApp").directive("phoneNumber",[function(){return{restrict:"A",link:function(e,t,n){t.on("keypress",function(e){var t=undefined,n=/[ \d\(\)+-]+$/,r=e.ctrlKey;e.which!=0&&e.charCode!=0?t=e.which:t=e.keyCode,t>32&&!n.test(String.fromCharCode(t))&&!r&&e.preventDefault()}),t.on("paste",function(e){e.originalEvent.clipboardData&&(e.target.value=e.originalEvent.clipboardData.getData("text/plain").replace(/[^\d]/g,"")),e.preventDefault()})}}}]);

angular.module("netangelsApp").directive("datepicker",[function(){return{restrict:"A",scope:{value:"=ngModel",options:"=datepicker"},link:function(e,t,n){t.datepicker(e.options)}}}]);

angular.module("netangelsApp").directive("netangelsTable",["$http","$parse","DirectiveUtils","Storage","Messages",function(e,t,n,r,i){return{restrict:"E",templateUrl:"/static/panel/js/templates/tables.html?v=7",replace:!0,transclude:!0,scope:!1,controller:"NetangelsTableController",link:function(t,s,o,u){t.instanceList=[],t.filtered=[],t.isLoaded=!1;var a=angular.element("body");t.currentPage=0,t.instanceUrl=n.parse(o.instanceUrl,"?json"),t.pageSizeChoice=[20,50,100];var f=r.get(window.location.pathname+"PageSize");t.pageSize=f||n.parse(o.pageSize,20);var l=n.parse(o.fields,[]);t.fields=n.parse(l,[]),t.sortFields=n.parse(o.sortFields,l),t.titles=n.parse(o.titles,[]),t.isShowSearch=n.parse(o.isShowSearch,!0),t.sizes=n.parse(o.sizes,!0),t.verboseName=n.parse(o.verboseName,""),t.fieldForTitle=n.parse(o.fieldForTitle,t.fields[0]);var c=r.get(window.location.pathname+"SortBy1"),h=r.get(window.location.pathname+"SortReverse");t.sortBy=c||n.parse(o.sortBy,t.sortFields[0]),t.sortReverse=h!==undefined?h:n.parse(o.sortReverse,!1),t.actions=n.parse(o.actions,{}),t.globalActions=n.parse(o.globalActions,[]),t.mainItemActions=n.parse(o.mainItemActions,[]),t.itemActions=n.parse(o.itemActions,[]),t.untrustedFields=n.parse(o.untrustedFields,[]),s.find("input, textarea").placeholder(),t.loadInstanceList=function(){e.get(t.instanceUrl).success(function(e,n,r,i){var s=[];angular.forEach(e,function(e,n){angular.isFunction(t.getItem)&&(e=t.getItem(e)),s.push(e)}),t.instanceList=s,angular.isFunction(t.afterFetch)&&t.afterFetch(),t.$emit("tableLoaded")}).error(function(e,t,n,r){t===500&&i.callErrorMessage("internalError",e.error_message)})};var p=function(e){e.keyCode===27&&t.$apply(function(){t.isShowItemActions=!1})};a.on("keydown",p),t.loadInstanceList()}}}]);

angular.module("netangelsApp").directive("netangelsModal",["$timeout",function(e){return{restrict:"E",templateUrl:"/static/panel/js/templates/modal.html?v=8",compile:function(t,n){return n.formController&&t.find("form").attr("ng-controller",n.formController),{pre:function(t,n,r,i){function s(){e(function(){var e=angular.element(window).height(),r;r=n.find(".window-wrapper").height(),t.isOverlayFixed=e>r,e>r&&n.find(".window-wrapper").css("margin-top",(e-r)/3)})}t.$on("compileTemplateComplete",s),e(function(){angular.isFunction(t.callbacks.onRender)&&t.callbacks.onRender(t,n)}),s()}}}}}]),angular.module("netangelsApp").directive("modal",["$http","Modal",function(e,t){return{restrict:"A",scope:{options:"=modal"},link:function(n,r,i,s){var o=r.attr("href");r.on("click",function(i){e.get(o).success(function(e,i,s,o){var u=angular.extend({},n.options),a=r.attr("title");a&&(u.title=a),u.template||(u.template=!u&&u.type!=="form"?e:e.html),modal=new t(u)}).error(function(e,t,n,r){}),i.preventDefault()})}}}]);

angular.module("netangelsApp").directive("netangelsInteractiveField",[function(){return{restrict:"E",templateUrl:"/static/panel/js/templates/interactive.html?v=1",controller:"netangelsInteractiveController",scope:!0}}]);

angular.module("netangelsApp").directive("attachments",["$http","$fileUploader","DirectiveUtils",function(e,t,n){return{restrict:"E",templateUrl:"/static/panel/js/templates/attachments.html?v=2",scope:!0,link:function(r,i,s){r.bundle=n.parse(s.bundle),r.attachments=n.parse(s.attachments,[]),r.maxFileSize=n.parse(s.maxFileSize,undefined),r.amountFile=n.parse(s.amountFile,undefined),r.accept=n.parse(s.accept,""),r.errors="";var o=t.create({url:"/attachments/"+r.bundle+"/",scope:r,headers:{"X-CSRFToken":angular.element.cookie("csrftoken")}}),u=o.bind("afteraddingfile",function(e,t){r.errors="",r.maxFileSize&&t.file.size/1048576>r.maxFileSize&&(r.errors="\u0420\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 "+r.maxFileSize+" Mb"),r.amountFile&&r.attachments.length>=r.amountFile&&(r.errors="\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0444\u0430\u0439\u043b\u043e\u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043e: "+r.amountFile),angular.forEach(r.attachments,function(e,n){t.file.name===e.name&&(r.errors="\u0424\u0430\u0439\u043b \u0443\u0436\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d.")}),r.errors?r.removeFromUploaderArray(t.file,o.queue):o.uploadItem(t)}),a=o.bind("complete",function(e,t,n,i){!r.errors&&r.attachments.push(i[0])}),f=o.bind("error",function(e,t,n){t.status===413?r.errors="\u0420\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 "+r.maxFileSize+" Mb":r.errors="\u041d\u0435\u043e\u0431\u044a\u044f\u0441\u043d\u0438\u043c\u0430\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430"});r.$on("modalDestroy",function(){u(),a(),f()}),r.removeFromUploaderArray=function(e,t){var n;angular.forEach(t,function(t,r){e.name===t.name&&(n=r)}),t.splice(n,1)},r.deleteAttachment=function(t){var n="/attachments/"+r.bundle+"/"+t.name+"/delete/";r.errors="",e.post(n).success(function(e,n,i,s){r.removeFromUploaderArray(t,o.queue),r.removeFromUploaderArray(t,r.attachments)})}}}}]);

angular.module("netangelsApp").directive("genPassword",["$compile",function(e){return{restrict:"A",require:"^ngModel",link:function(t,n,r){var i;n.genPasswd(),i=n.prev(),i.attr("ng-model",r.ngModel),e(i)(t)}}}]);

angular.module("netangelsApp").directive("outsideClick",["$document",function(e){return{link:function(t,n,r){var i=r.outsideClick,s=function(e){var r=n.find(e.target).length>0;r||t.$apply(i)};e.on("click",s),n.on("$destroy",function(){e.off("click",s)})}}}]);

angular.module("netangelsApp").directive("passwordCheckForm",["$compile","$timeout","PasswordChecker",function(e,t,n){return{restrict:"A",link:function(r,i,s){var o=i.find("#"+(s.passwordid||"id_password")),u=4,a=/[A-Za-z0-9!"#$%&\'()*+,-./:;<=>?@\[\\\]^_'{|}~]/,f=angular.element("<span></span>"),l=o.parent().find("span.errors").find("ul.errorlist"),c=null;r.score="empty",r.complexityString={deniedSymbols:"\u041f\u0430\u0440\u043e\u043b\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b","short":"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",0:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0441\u043b\u0430\u0431\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",1:"\u041e\u0447\u0435\u043d\u044c \u0441\u043b\u0430\u0431\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",2:"\u0421\u043b\u0430\u0431\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",3:"\u0425\u043e\u0440\u043e\u0448\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",4:"\u041e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"},o.attr("ng-model","password"),o.attr("ng-trim","false"),f.attr("ng-if","complexityString[score] !== undefined"),f.attr("class","passComplexity complexity_{{score}}"),f.attr("ng-bind","complexityString[score]"),o.parent().append(f),r.$watch("password",function(e,i){typeof r.password=="string"&&(e!=""?a.test(e)?e.length<u?r.score="short":(c!=null&&t.cancel(c),c=t(function(){n.check(e).then(function(e){r.score=e.score}),c=null},500)):r.score="deniedSymbols":r.score="empty",l.remove())}),e(o)(r),e(f)(r)}}}]);

angular.module("netangelsApp").directive("selectSlide",["$timeout",function(e){return{restrict:"A",scope:{selectSlide:"="},link:function(t,n,r){var i=angular.extend({},t.selectSlide),s=i.unit||"GB";e(function(){n.SelectSlide({unit:s})})}}}]);

angular.module("netangelsApp").provider("PasswordChecker",[function(){var e=this;this.url="/password/check/",this.$get=["$http","$q",function(t,n){function r(r){var i=n.defer(),s=$.param({password:r});return t.post(e.url,s).success(function(e,t,n,r){t==200&&i.resolve(e),i.reject()}).error(function(e,t,n,r){i.reject()}),i.promise}return{check:r}}]}]);

angular.module("netangelsApp").constant("PanelSettings",{NETANGELS_DNS:["ns1.netangels.ru","ns2.netangels.ru","ns3.netangels.ru","ns4.netangels.ru"]});

angular.module("netangels.ws",[]).run();

angular.module("netangels.ws").provider("ws",[function(){function f(){}function l(u,a){var l=this;this._centrifuge=null,this._user=null,this._getCentrifuge=function(){var r=a.defer();if(l._centrifuge instanceof Centrifuge)r.resolve(l._centrifuge);else{if(!e||!t)throw new Error("[netangels.ws] is configure incorrectly");u.get(t).success(function(t,i,s,o){if(i==200){var u=t.identifier,a=t.timestamp,f=t.token,c={url:e,user:u,timestamp:a,token:f};n!=null&&(c.authEndpoint=n,c.authHeaders={"X-CSRFToken":$.cookie("csrftoken")}),l._user=u,l.wsApi.centrifuge=l._centrifuge=new Centrifuge(c),r.resolve(l._centrifuge)}else r.reject("[netangels.ws] configure status != 200, status: "+i)}).error(function(e,t,n,i){r.reject("[netangels.ws] can't connect to backend")})}return r.promise},this.connect=function(e){l._getCentrifuge().then(function(t){!t.isConnected()&&t._status!="connecting"&&t.connect(),t.startAuthBatching(),e(l.wsApi),t.stopAuthBatching()},function(e){throw new Error(e)})},this.wsApi={mainChannel:function(){return r},userChannel:function(){return i!="admin"?this.getChannel(s,l._user,!0):angular.isDefined(window.userLogin)?this.getChannel(s,window.userLogin,!0):null},adminChannel:function(){return i=="admin"?this.getChannel(o,l._user,!0):null},allAdminChannel:function(){return i=="admin"?this.getChannel(o,!1,!0):null},getChannel:function(e,t,n){var r=e;return n&&r[0]!="$"&&(r="$"+r),t?r+"#"+t:r},subscribe:function(e,t,n){function r(t){t.data.app==e&&this.trigger(t.data.event,t.data.metadata)}if(angular.isUndefined(n))throw"Method subscribe required $scope";var i=new f;return i.subscriber=this.centrifuge.subscribe(t,angular.bind(i,r)),n.$on("$destroy",angular.bind(i,i.unsubscribe)),i}}}var e=null,t=null,n=null,r=null,i=null,s="panel",o="admin",u=this,a={admin:o,user:s};this.wsClient=null,this.configure=function(s){e=s.url,t=s.tokenUrl,i=s.panelType,r=a[s.panelType],n=s.signPrivateChannelUrl},angular.extend(f.prototype,Eventable),f.prototype.unsubscribe=function(){this.off(),this.subscriber=null},this.$get=["$http","$q",function(e,t){return function(n){u.wsClient instanceof l||(u.wsClient=new l(e,t)),u.wsClient.connect(n)}}]}]);

angular.module("netangelsApp").service("UrlParamsReplacer",[function(){return NETANGELS.util.urlParamsReplacer}]);

angular.module("netangelsApp").controller("NetangelsTableControllerNp",["$scope","$rootScope","TableAction","TableCell",function(e,t,n,r){e.runAction=function(e,n,r){t.$broadcast("Table:runAction");var i=e._actions;angular.isDefined(i)&&angular.isDefined(i[n])&&i[n].run(r),r.preventDefault()},e.showField=function(e,t){return e.show(e.instance,t)},e.getClass=function(e,t){return angular.isFunction(e.additionalClass)?e.additionalClass(e.instance,t):angular.isString(e.additionalClass)?[e.additionalClass]:e.additionalClass},e.createInstance=function(t){return angular.isObject(t.fields)||(t.fields={}),angular.isObject(t._actions)||(t._actions={}),angular.forEach(e.fields,function(n,i){n.actionOptions=e.fieldActionsAttr[i]||{},t.fields[i]=r.create(i,t,n)}),angular.forEach(e.instanceActions,function(r,i){t._actions[i]=n.create(t,r,e.instanceActionsAttr[i])}),t},e.addInstance=function(t){var n=e._instanceList;for(var r=0;r<n.length;r++){var i=n[r];if(i.id===t.id)return e._instanceList[r]=angular.extend(n[r],t),e._instanceList[r]}var s=e.createInstance(t);return e._instanceList.push(s),s},e.removeInstance=function(t){var n=e._instanceList;for(var r=0;r<n.length;r++){var i=n[r];i.id===t.id&&e._instanceList.splice(r,1)}},e.search=function(){var t=[],n=angular.element(".np__search").val();return n.replace(/ /g,"").length>0?(angular.forEach(e._instanceList,function(r){var i=e.searchOptions.searchFields;angular.forEach(i,function(e){var i=r[e];if(i&&i.indexOf(n)>-1){var s=t.filter(function(e){return e.id==r.id}).length!=0;s||t.push(r)}})}),t):e._instanceList},e.getGlobalActions=function(){return e._globalActions},e.getAdditionalLink=function(){return e.hasOwnProperty("additionalLinks")?e.additionalLinks:null},e.isSearchShow=function(){return e.isSearchAllow==1&&e._instanceList.length>0}}]);

angular.module("netangelsApp").controller("ProgressBarController",["$scope",function(e){e.percent=0,e.setPercent=function(t,n){if(e.progressbarID!=null&&n!=null&&n!=e.progressbarID)return;e.percent=t}}]);

angular.module("netangelsApp").service("Confirm",["$compile","$rootScope","$sce","$location","Messages",function(e,t,n,r,i){function a(e,t){return e+":"+t}function f(f,l,c){var h=angular.element("<netangels-confirm></netangels-confirm>"),p=c?c.$new():t.$new(),d=f.reloadPage,v=f.routeTo,m=f.redirectTo;angular.isObject(u)&&u.scope.reject(),f.formController&&h.attr("form-controller",f.formController),f=angular.extend({},s,f);var g=f.as_div;angular.isString(f.message)&&(g=f.message),f.formType&&(h.attr("form-type",f.formType),p.formType=f.formType),p.template=n.trustAsHtml(g),p.description=n.trustAsHtml(f.description),p.actionUrl=f.actionUrl,p.actionMethod=f.actionMethod,p.updateTable=f.updateTable,p.updateInstance=f.updateInstance,p.formController=f.formController,p.actionType=f.actionType,p.onAfterSuccess=f.onAfterSuccess,p.addClass=f.addClass,p.isShowRejectButton=f.isShowRejectButton,p.isShowSubmitButton=f.isShowSubmitButton,p.submitButtonName=f.submitButtonName,p.rejectButtonName=f.rejectButtonName,p.defaultOnSuccess=function(e,n,s,o){var u=e.redirect||m;u&&window.location.replace(u),d&&t.$broadcast("page:reload"),v&&r.path(v);if(angular.isObject(p.updateTable)){var a=p.updateTable.name;angular.isString(a)||(a="all"),t.$broadcast("table:update",{name:a})}p.updateInstance==1&&t.$broadcast("instance:instanceReload",{instance:e}),angular.isFunction(p.onAfterSuccess)&&p.onAfterSuccess(e);var f="confirm:success";angular.isString(p.actionType)&&(f+=":"+p.actionType),p.$emit(f,e),t.$broadcast("root:"+f,e),i.fetch(),p.reject()},p.onSuccess=function(e,t,n,r){p.defaultOnSuccess(e,t,n,r)},p.getSubmitButtonName=function(){return p.submitButtonName},p.getRejectButtonName=function(){return p.rejectButtonName};var y=a(p.actionUrl,p.actionMethod),b=function(e){e.keyCode===27&&p.$apply(function(){p.reject()})};p.defaultReject=function(e){e||(o.off("keydown",b),h.remove(),u=null)},p.reject=angular.isFunction(f.reject)?function(e){return f.reject(p,e)}:p.defaultReject,angular.isFunction(f.accept)&&(p.accept=function(){return f.accept(p)}),o.on("keydown",b);var w=e(h)(p);return angular.element(l).append(w),u={token:y,scope:p},{close:p.reject,scope:p}}var s={template:"",description:"",actionUrl:".",actionMethod:"POST",updateTable:undefined,updateInstance:!1,addClass:"",formController:undefined,formType:"confirm",submitButtonName:"\u0414\u0430",rejectButtonName:"\u041d\u0435\u0442",isShowRejectButton:!0,isShowSubmitButton:!0},o=angular.element("body"),u;return f.checkToken=function(e,t){return angular.isObject(u)&&angular.isDefined(u.token)&&a(e,t)===u.token?!0:!1},f}]),angular.module("netangelsApp").service("ConfirmUtils",["$q","Confirm",function(e,t){return{makeConfirmPromise:function(n,r){var i=e.defer(),s=new t({formType:"question",accept:function(e){i.resolve(),e.defaultReject()},reject:function(e,t){i.reject(),e.defaultReject(t)},message:n},r);return i.promise}}}]);

angular.module("netangelsApp").directive("netangelsTabs",["$compile","$sce","$location","$timeout","DirectiveUtils","$filter",function(e,t,n,r,i,s){return{restrict:"E",scope:!1,link:function(o,u,a){function c(e){for(var t in o.tabs){var n=o.tabs[t];if(e&&n["hash"]==e&&!n.isDisabled()&&n.isShow())return t}return 0}function h(){r(function(){var t=u.find(".np__tabsContent").children("div");angular.forEach(t,function(e,t){var n=angular.extend(o.tabOptions[t],{element:$(e)});if(n.hash!=null&&o.exclude.indexOf(n.hash)!==-1)return;o.tabs.push(f(n))});var r=e("<netangels-tabs-header></netangels-tabs-header>")(o);o.countMainTabs=s("filter")(o.tabs,{tabGroup:!1}).length,u.prepend(r),n.hash().length>0&&(l=c(n.hash())),o.setTab(l)})}var f=function(e){if(this instanceof f){var n=this;return n.extendClass=e.class,n.text=e.text,n.element=e.element,n.hash=e.hash,n.tabGroup=e.tabGroup||!1,n.isShow=e.isShow||function(){return!0},n.isDisabled=angular.isFunction(e.isDisabled)?e.isDisabled:function(){return!1},n.tabElementClass=angular.isString(e.tabElementClass)?e.tabElementClass:"",angular.isFunction(e.render)?n.renderFunction=e.render:n.renderFunction=function(e){return'<div class="np__tabIcon '+e.extendClass+'"></div>'+"<div>"+e.text+"</div>"+'<div class="clear"></div>'},{html:function(){return t.trustAsHtml(n.renderFunction(n))},isShow:n.isShow,isDisabled:n.isDisabled,tabElementClass:n.tabElementClass,element:n.element,hash:n.hash,text:n.text,tabGroup:n.tabGroup}}return new f(e)},l=0;o.tabs=[],o.exclude=i.parse(a.exclude,[]),o.setTab=function(e){angular.forEach(o.tabs,function(t,n){e==n?t.element.show():t.element.hide()}),o.currentTab=e,r(function(){n.hash(o.tabs[o.currentTab].hash),o.$broadcast("tabs:changeTab",o.tabs[o.currentTab])})},o.getTabByHash=function(e){var t=o.tabs.map(function(e){return e.hash}).indexOf(e);return t},o.getTabListName=function(){return o.currentTab>=o.countMainTabs?o.tabsList.name+" - "+o.tabs[o.currentTab].text:o.tabsList.name},o.getTabListClass=function(){if(o.currentTab>=o.countMainTabs)return"np__"+o.tabs[o.currentTab].hash},o.currentTab=-1,o.$on("$locationChangeSuccess",function(e,t,r){n.hash()&&o.setTab(c(n.hash()))}),h()}}}]),angular.module("netangelsApp").directive("netangelsTabsHeader",[function(){return{restrict:"E",replace:!0,templateUrl:"/static/np/js/templates/tabs/tabs_header.html?v=3"}}]);

angular.module("netangelsApp").directive("netangelsTableNp",["$http","TableAction","Messages","DefaultActions","DirectiveUtils","UrlParamsReplacer",function(e,t,n,r,i,s){return{restrict:"E",templateUrl:"/static/np/js/templates/tables/tables.html?v=6",replace:!0,transclude:!0,scope:!1,controller:"NetangelsTableControllerNp",link:function(r,o,u){function a(e){var t=[];angular.isFunction(r.beforeTableLoaded)&&r.beforeTableLoaded(),angular.forEach(e,function(e,n){t.push(r.createInstance(e))}),r._instanceList=t,angular.isFunction(r.afterTableLoaded)&&r.afterTableLoaded(),r.$emit("table:tableLoaded")}function f(){angular.forEach(r.globalActions,function(e,n){r._globalActions[n]=t.create(r._instanceList,e,r.globalActionsAttr[n])})}function l(t){e.get(t).success(function(e,t,n,r){a(e)}).error(function(e,t,r,i){t===500&&n.callErrorMessage("internalError",e.error_message)})}function c(e,t){return angular.isString(e)&&t==e?!0:angular.isArray(e)&&e.indexOf(t)!=-1?!0:!1}function p(e,t){var n=h,r=h;return e&&(r=function(t,r){return n(e(t),e(r))}),t?function(e,t){return r(e,t)*-1}:r}function d(e){var t=[],n=e.length,r,i,s,o;for(var u=0;u<n;u++)r=e[u],angular.isString(r)?(i=r,o=h):(i=r.name,o=p(r.primer,r.reverse)),t.push({name:i,comparison:o});return function(e,i){var s,o,u,a;for(var f=0;f<n;f++){a=0,r=t[f],u=r.name,a=r.comparison(e[u],i[u]);if(a!==0)break}return a}}r._instanceList=[],r.name=i.parse(u.name),r.fieldList=i.parse(u.fields),r.showIfEmpty=i.parse(u.showIfEmpty,!0),r.isSearchAllow="searchable"in u,r.searchInput=null,r.searchOptions=i.parse(u.searchable,{searchFields:["id"]}),r.header=i.parse(u.header),r.instanceUrl=i.parse(u.instanceUrl,"?json"),r.refreshUrl=i.parse(u.refreshUrl,"?json&pk={id}"),r.globalActionsAttr=i.parse(u.globalActions,{}),r.instanceActionsAttr=i.parse(u.instanceActions,{}),r.fieldActionsAttr=i.parse(u.fieldActions,{}),r.groupOptions=i.parse(u.group),r.isGroupedTable=r.groupOptions!=null,r.emptyGroupTitleDefault="\u041f\u0443\u0441\u0442\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430",r.sortFields=i.parse(u.sortFields,["id"]),r._globalActions={},r.sortedFieldList=[],r.groupMap={},r.tableConfig=angular.extend({rootElementClass:[]},r.tableConfig),function(t){r.sortedFieldList.push(t[0]),angular.forEach(t.slice(1).reverse(),function(e){r.sortedFieldList.push(e)})}(r.fieldList),r.$on("table:tableLoaded",function(){f()}),r.loadInstanceList=function(){angular.isFunction(r.getInstanceList)?a(r.getInstanceList()):l(r.instanceUrl)},r.loadInstanceList(),r.instanceList=function(){return r.search(r._instanceList)},r.$on("table:update",function(e,t){(t.name=="all"||c(t.name,r.name))&&angular.isDefined(r.instanceUrl)&&l(r.instanceUrl)}),r.isShow=function(){return r.showIfEmpty==1||r.showIfEmpty==0&&r.instanceList().length>0};var h=function(e,t){if(e==t)return 0;var n=e<t?-1:1;return e==null?n=1:t==null&&(n=-1),n};r.$watchCollection(function(){return r.instanceList()},function(e){var t={},n=r.groupOptions&&r.groupOptions.by||null,i=r.groupOptions&&r.groupOptions.empty||r.emptyGroupTitleDefault,s=e.slice();s.sort(d(r.sortFields)),angular.forEach(s,function(e){var s;n==null?s=i:(s=i,e[n]&&(s=e[n],angular.isFunction(r.getGroupTitle)&&(s=r.getGroupTitle(s,n)))),t.hasOwnProperty(s)||(t[s]=[]),t[s].push(e)}),r.groupMap=t}),r.refreshInstance=function(e){var t=s.replace(r.refreshUrl,e);$.ajax({url:t,dataType:"json",cache:!1,data:{},success:function(e,t,n){r.addInstance(e)},error:function(t){r.awaiting!=null&&angular.isFunction(r.awaiting.onError)&&r.awaiting.onError(e)}})}}}}]);

angular.module("netangelsApp").directive("progressBar",["$timeout","$sce","DirectiveUtils",function(e,t,n){return{restrict:"E",replace:!0,scope:{percent:"@"},controller:"ProgressBarController",templateUrl:"/static/np/js/templates/tables/progress.html",link:function(r,i,s){r.progressText=n.parse(s.progresstext),r.progressbarID=n.parse(s.progressbarid),r.percent=n.parse(s.percent),r.showProgress=String(r.percent)!="null",r.$on("progressBar:percent",function(e,t){r.setPercent(t.percent,t.progressbarID)}),r.$watch("percent",function(){r.percent==100?(r.progressText=t.trustAsHtml('<div class="done">\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e</div>'),e(function(){r.showProgress=!1},1200)):String(r.percent)!="null"&&(r.showProgress=!0)})}}}]);

angular.module("netangelsApp").service("TableCell",["$sce","$http","Confirm","TableAction","DefaultActions","DirectiveUtils",function(e,t,n,r,i,s){function o(t){this.name=t.name,this.instance=t.instance,this.isRenderCacheEnable=s.parse(t.isRenderCacheEnable,!0),this.isCompilable=s.parse(t.isCompilable,!1),this._renderCache=null,this.html=function(){return this.isRenderCacheEnable&&this._renderCache==null&&(this._renderCache=e.trustAsHtml(this.render(this.instance))),this._renderCache==null?e.trustAsHtml(this.render(this.instance)):this._renderCache},this.render=angular.isFunction(t.render)?t.render:function(e){return e},this.show=angular.isFunction(t.show)?t.show:function(){return!0},this.additionalClass=t.additionalClass;if(angular.isObject(t.actions)){var n=this;n._actions={},angular.forEach(t.actions,function(e,i){var s=angular.extend({isTableEvent:!0},t.actionOptions);n._actions[i]=r.create(n.instance,e,s)})}}return{create:function(e,t,n){return new o(angular.extend({name:e,instance:t},n))}}}]),angular.module("netangelsApp").service("TableAction",["UrlParamsReplacer","DefaultActions",function(e,t){function r(r){this.instance=r.instance,this._data=r.data||{},angular.extend(r.actionOptions,r.options),function(){angular.forEach(r.actionOptions,function(t,n){n=="url"&&(r.actionOptions[n]=e.replace(t,r.instance))})}(),this.run=function(e){var t=this.onAction(this.instance,angular.extend({event:e},r.actionOptions));return e.stopPropagation(),t},this.getData=function(e){return this._data[e]};var i=r.onAction,s=r.isShow,o=r.isEnabled;!i&&angular.isString(r.actionType)&&(i=t[r.actionType]),this.onAction=angular.isFunction(i)?i:angular.noop,this.isShow=angular.isFunction(s)?s:n,this.isEnabled=angular.isFunction(o)?o:n}var n=function(){return!0};return{create:function(e,t,n){return t=angular.extend({},t),t.actionOptions=angular.extend({},n),new r(angular.extend({instance:e},t))}}}]),angular.module("netangelsApp").service("DefaultActions",["$http","$location","Confirm",function(e,t,n){return{getConfirm:function(t,r){var i=$(r.event.currentTarget);r.isTableEvent==1&&(i=i.closest(".np__mainItem")),e.get(r.url+"?form").success(function(e,t,s,o){var u=angular.extend({actionUrl:r.url},e);r.updateTable&&(u.updateTable=r.updateTable),r.addClass&&(u.addClass=r.addClass),r.onAfterSuccess&&(u.onAfterSuccess=r.onAfterSuccess),r.formController&&(u.formController=r.formController);var a=new n(u,i)}),angular.isDefined(r.event)&&r.event.preventDefault()},redirect:function(e,t){window.location.replace(t.url)},changeLocation:function(e,n){t.path(n.url)}}}]);

angular.module("netangelsApp").service("IntervalManager",[function(){var e=function(e,t,n){return{code:e,delay:t,fid:n}};return function(){var t=[];return{setInterval:function(n,r){var i=setInterval(n,r);return t.push(e(n,r,i)),i},clearInterval:function(e){t=t.filter(function(t){return t.fid!=e}),clearInterval(e)},clearAll:function(){t.forEach(function(e){clearInterval(e.fid)})}}}}]);

angular.module("netangelsApp").service("RouteHelper",[function(){return{createLoadEvent:function(e,t,n){var r=angular.element('<div class="cssload-main"><span class="cssload-spinner"><div>\u0413\u043e\u0442\u043e\u0432\u0438\u043c \u0434\u0430\u043d\u043d\u044b\u0435...</div></span></div>');n=n||".loaderWrapper",e.$on("$routeChangeStart",function(){t.parent().find(n).html(r),t.hide()}),e.$on("$routeChangeSuccess",function(){t.parent().find(".cssload-main").remove(),t.show()}),e.$on("$routeChangeError",function(){t.parent().find(".cssload-main").remove(),t.show()})}}}]);

angular.module("netangelsApp").directive("netangelsScopeInstance",["$http","$rootScope","$routeParams","$timeout","Messages","DirectiveUtils","UrlParamsReplacer",function(e,t,n,r,i,s,o){return{restrict:"E",scope:!0,replace:!0,link:function(u,a,f){function c(n){e.get(n).success(function(e,n,i,s){var o={};angular.isFunction(u.getData)?angular.extend(o,u.getData(u,e)):(u.instance=e,o={instance:u.instance}),r(function(){t.$broadcast("instance:instanceLoaded",o)})}).error(function(e,t,n,r){t==500&&i.callErrorMessage("internalError",e.error_message)})}var l=o.replace(s.parse(f.instanceUrl,"?json"),n);u.instance=null,u.awaitingOptions=s.parse(f.awaitingOptions,{}),u.$on("instance:instanceReload",function(e,t){u.reloadInstance(t)}),u.reloadInstance=function(e){if(angular.isObject(e)){if(angular.isDefined(e.instance)){u.instance=e.instance,t.$broadcast("instance:instanceLoaded",{instance:u.instance});return}angular.isDefined(e.url)&&c(e.url)}else c(l)},u.refreshInstance=function(e){u.instance.id==e.id&&u.reloadInstance()},angular.isFunction(u.getInstance)?(u.instance=u.getInstance(),t.$broadcast("instance:instanceLoaded",{instance:u.instance})):c(l)}}}]);

angular.module("netangelsApp").controller("NetangelsCheckboxConfirm",["$scope","$element","$http","Confirm","UrlParamsReplacer",function(e,t,n,r,i){e.toggleCheckbox=function(s){var o=e.updateInstance!=null?e.updateInstance:!0,u=e.href;s.preventDefault(),angular.isObject(e.urlContext)&&(u=i.replace(u,e.urlContext)),n.get(u+"?form").success(function(n,i,s,a){var f=angular.extend({actionUrl:u},n),l=new r(f,t);l.scope.onSuccess=function(t,n,r,i){l.scope.defaultOnSuccess(t,n,r,i),o&&e.$emit("instance:instanceReload",{instance:t})}})}}]);

angular.module("netangelsApp").directive("netangelsConfirm",[function(){return{restrict:"E",replace:!0,templateUrl:function(e,t){return t.formType?"/static/np/js/templates/confirm/"+t.formType+".html?v=1":"/static/np/js/templates/confirm/confirm.html?v=2"},compile:function(e,t){t.formController&&e.find("form").attr("ng-controller",t.formController)}}}]),angular.module("netangelsApp").directive("netangelsConfirm",["$http","Confirm","DirectiveUtils","UrlParamsReplacer",function(e,t,n,r){return{restrict:"A",scope:{href:"@href",urlContext:"=urlContext"},link:function(i,s,o){s.on("click",function(u){var a=i.href,f;angular.isObject(i.urlContext)&&(a=r.replace(a,i.urlContext)),i.options=n.parse(o.netangelsConfirm),angular.isObject(i.options)||(i.options={}),i.options.hasOwnProperty("actionUrl")||(i.options.actionUrl=a),i.options.hasOwnProperty("actionMethod")||(i.options.actionMethod="POST"),t.checkToken(i.options.actionUrl,i.options.actionMethod)||e.get(a+"?form").success(function(e,n,r,o){var u=angular.extend({},i.options,e);f=new t(u,s,i)}),u.preventDefault()})}}}]),angular.module("netangelsApp").directive("netangelsCheckboxConfirm",[function(){return{restrict:"E",scope:{checkboxId:"@checkboxId",href:"@href",checkboxText:"@checkboxText",isChecked:"=watchCheckedVariable",urlContext:"=urlContext",updateInstance:"=updateInstance"},replace:!0,templateUrl:"/static/np/js/templates/confirm/checkbox.html?v=2",controller:"NetangelsCheckboxConfirm"}}]);

angular.module("netangelsApp").controller("NetangelsStatisticController",["$scope","$element","$http","$timeout","$q",function(e,t,n,r,i){var s="DD.MM.YYYY",o=moment();e.metrics={},e.dataStatistic=!1,e.periodMap={day:"\u0414\u0435\u043d\u044c",week:"\u041d\u0435\u0434\u0435\u043b\u044f",month:"\u041c\u0435\u0441\u044f\u0446"};var u={ckvm_io_read:"\u0427\u0442\u0435\u043d\u0438\u0435",ckvm_io_write:"\u0417\u0430\u043f\u0438\u0441\u044c",ckvmcpu:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 CPU, \u0432 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430\u0445 \u043e\u0442 \u043c\u043e\u0449\u043d\u043e\u0441\u0442\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u044f\u0434\u0440\u0430",ckvm_traffic_in:"\u0412\u0445\u043e\u0434\u044f\u0449\u0438\u0439",ckvm_traffic_out:"\u0418\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439"};e.sortPeriod=["day","week","month"],e.metricGroup={},e.init=function(){n.get(e.url).success(function(t,n,r,i){var s=e.periodMap,o=angular.isObject(e.metricMap)?e.metricMap:{};angular.forEach(t,function(n,r){o.hasOwnProperty(r)&&(e.metricGroup[r]=$.map(t[r],function(e,t){if(t in s)return t}).sort(function(t,n){return e.sortPeriod.indexOf(t)}))}),e.metrics=t,e.currentMetric=Object.keys(e.metrics)[0],e.currentPeriod=Object.keys(e.metrics[e.currentMetric])[0],e.getStatisticByUrl()}).error(function(e,t,n,r){})};var a=function(e){return function(t){return e[t]}};e.getPeriodName=a(e.periodMap),e.getMetricName=a(e.metricMap),e.currentMetric="",e.currentPeriod="",e.setCurrentMetric=function(t){e.currentMetric!=t&&(e.currentMetric=t,e.getStatisticByUrl())},e.setCurrentPeriod=function(t){e.currentPeriod!=t&&(e.currentPeriod=t,e.getStatisticByUrl())},e.getStatisticByUrl=function(){function l(e,t){return e=e.label,t=t.label,e==t?0:e<t?-1:1}var t=[],r=e.metrics[e.currentMetric][e.currentPeriod];typeof r=="object"?angular.forEach(r,function(e,n){t.push(e)}):t.push(r);var s=[];e.dataStatistic=!1;var o=[];for(var a=0;a<t.length;a++){var f=n.get(t[a]).success(function(e,t,n,r){angular.forEach(u,function(t,n){e.data_name.indexOf(n)>-1&&(e.label=u[n])}),e.data!=null&&s.push(e)}).error(function(e,t,n,r){});o.push(f)}i.all(o).then(function(){e.dataStatistic=s.sort(l)})}}]);

angular.module("netangelsApp").directive("netangelsStatistic",[function(){return{restrict:"E",scope:!1,replace:!0,templateUrl:"/static/np/js/templates/statistic/statistic.html?v=3",controller:"NetangelsStatisticController",link:function(e,t,n){e.url=n.href,e.init()}}}]);

angular.module("netangelsApp").directive("changeableSrc",["DirectiveUtils",function(e){return{restrict:"A",link:function(t,n,r){var i=e.parse(r.changeableSrc,{}),s=angular.element("<div>"+i.errorMessage+"</div>"),o=angular.element('<div class="cssload-main"><span class="cssload-spinner"><div>\u0413\u043e\u0442\u043e\u0432\u0438\u043c \u0434\u0430\u043d\u043d\u044b\u0435...</div></span></div>');n.on("error",function(){o.remove(),n.parent().append(s),n.hide()}),n.on("load",function(){o.remove(),s.remove(),n.show()}),t.$on("changeImage",function(){n.parent().append(o),s.remove(),n.hide()})}}}]);

$(document).ajaxSend(function(e,t,n){function r(e){var t=null;if(document.cookie&&document.cookie!=""){var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=jQuery.trim(n[r]);if(i.substring(0,e.length+1)==e+"="){t=decodeURIComponent(i.substring(e.length+1));break}}}return t}function i(e){var t=document.location.host,n=document.location.protocol,r="//"+t,i=n+r;return e==i||e.slice(0,i.length+1)==i+"/"||e==r||e.slice(0,r.length+1)==r+"/"||!/^(\/\/|http:|https:).*/.test(e)}function s(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}!s(n.type)&&i(n.url)&&t.setRequestHeader("X-CSRFToken",r("csrftoken"))});

$(function(){$.datepicker.regional.ru={closeText:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",prevText:"&#x3c;\u041f\u0440\u0435\u0434",nextText:"\u0421\u043b\u0435\u0434&#x3e;",currentText:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",monthNames:["\u042f\u043d\u0432\u0430\u0440\u044c","\u0424\u0435\u0432\u0440\u0430\u043b\u044c","\u041c\u0430\u0440\u0442","\u0410\u043f\u0440\u0435\u043b\u044c","\u041c\u0430\u0439","\u0418\u044e\u043d\u044c","\u0418\u044e\u043b\u044c","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u041e\u043a\u0442\u044f\u0431\u0440\u044c","\u041d\u043e\u044f\u0431\u0440\u044c","\u0414\u0435\u043a\u0430\u0431\u0440\u044c"],monthNamesShort:["\u042f\u043d\u0432","\u0424\u0435\u0432","\u041c\u0430\u0440","\u0410\u043f\u0440","\u041c\u0430\u0439","\u0418\u044e\u043d","\u0418\u044e\u043b","\u0410\u0432\u0433","\u0421\u0435\u043d","\u041e\u043a\u0442","\u041d\u043e\u044f","\u0414\u0435\u043a"],dayNames:["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"],dayNamesShort:["\u0432\u0441\u043a","\u043f\u043d\u0434","\u0432\u0442\u0440","\u0441\u0440\u0434","\u0447\u0442\u0432","\u043f\u0442\u043d","\u0441\u0431\u0442"],dayNamesMin:["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"],weekHeader:"\u041d\u0435",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},$.datepicker.setDefaults($.datepicker.regional.ru)});

var interfacePluginsModule=function(){function e(e){var t=e.find("th, .label").not(".noTool");t.each(function(){var e=$(this).find(".help_text").html();e&&$(this).children("label").tooltipster({content:$(this).find(".help_text").html(),position:"top-right",delay:"10",maxWidth:300,interactive:!0,arrowColor:"#208FC6",theme:".tooltipster-shadow",offsetX:9})})}function t(e){e.find("[title]").not(".noTool").each(function(){var e=$(this).attr("title").length;e>0&&$(this).tooltipster({position:"right",delay:"10",maxWidth:300,interactive:!0,arrowColor:"#208FC6",theme:".tooltipster-shadow"})})}function n(e){e.find("select").not(".noChosen").not(":hidden").chosen({disable_search_threshold:10,width:"340px",placeholder_text_single:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435"})}return{refreshTool:function(r){$("input[id$=password]").not(".noGen").genPasswd(),n(r),e(r),t(r),$("input, textarea").placeholder()},addTooltipInput:e,addTooltipTitle:t,addChosen:n}}();$(function(){var e=$("body").children(".bodyContent");interfacePluginsModule.refreshTool(e),$(document).bind("scroll",function(){var e=$(this).scrollTop();scope=100,fixedCVDSDiv=$(".fixedDivCreate"),fixedCVDSDiv.length>0&&(e>scope?fixedCVDSDiv.addClass("fixedTop"):fixedCVDSDiv.removeClass("fixedTop"))})});

var NETANGELS={};typeof NETANGELS.util=="undefined"&&(NETANGELS.util={}),typeof NETANGELS.widget=="undefined"&&(NETANGELS.widget={}),typeof NETANGELS.data=="undefined"&&(NETANGELS.data={});if(typeof get_format=="undefined")var get_format=function(e){return e};Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(this===undefined||this===null)throw new TypeError('"this" is null or not defined');var n=this.length>>>0;t=+t||0,Math.abs(t)===Infinity&&(t=0),t<0&&(t+=n,t<0&&(t=0));for(;t<n;t++)if(this[t]===e)return t;return-1}),$(function(){var e=$("body").find("th").not(".noTool");e.each(function(){var e=$(this).find(".help_text").html();e&&$(this).children("label").tooltipster({content:$(this).find(".help_text").html(),position:"top-right",delay:"10",maxWidth:300,interactive:!0,arrowColor:"#e6f2f7",theme:".tooltipster-shadow",offsetX:9})})}),$(document).keydown(function(e){var t=27;e.which==t&&($(".overlay").remove(),$.fancybox!==undefined&&$.fancybox.close())});

(function(e){e.fn.genPasswd=function(t){var n,r,i,s,o,u,a=this,f=this.get(0);settings=e.extend({bAmbiguous:!1,bCapitalize:!0,bNumerals:!0,bSymbols:!1,iLength:10,iCount:5,sConfirm:null},t);if(a.parent().hasClass("newInput"))return;var l=e("<span/>").attr("class","pass_button fa-key").attr("title","\u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c").addClass("noTool"),c=e("<span/>").attr("class","showHide_button fa-eye").attr("title","\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c/\u0421\u043a\u0440\u044b\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c").addClass("noTool"),h=e("<div/>").attr("class","clear"),p=e(a).wrap("<div class='newInput'></div>");a.parent().append(c,l,h);var d=e("<input>").attr({type:"text",autocomplete:"off","class":a.attr("class"),placeholder:a.attr("placeholder"),name:a.attr("name"),id:a.attr("id")+"_raw"}).insertAfter(a).val(a.val()).hide().prop("disabled",!0);u={ambiguous:settings.bAmbiguous,capitalize:settings.bCapitalize,secure:settings.bSecure,numerals:settings.bNumerals,symbols:settings.bSymbols,length:settings.iLength,count:settings.iCount},l.click(function(){e.getJSON("/pwgen/",u,function(e){var t=e[0];a.empty().val(t).hide().prop("disabled",!0),d.empty().val(t).show().prop("disabled",!1),a.trigger("input")})}),e(".showHide_button").on("click",function(){a.css("display")==="none"?(a.val(d.val()),a.show().prop("disabled",!1),d.hide().prop("disabled",!0)):(d.val(a.val()),a.hide().prop("disabled",!0),d.show().prop("disabled",!1))}),a.on("input",function(){d.val()!=a.val()&&(d.val(a.val()),d.trigger("input"))}),d.on("input",function(){d.val()!=a.val()&&(a.val(d.val()),a.trigger("input"))});try{var v=a.add(d);v.on("focusin",function(){e(this).closest(".newInput").addClass("divFocus")}),v.on("focusout",function(){e(this).closest(".newInput").removeClass("divFocus")})}catch(m){}}})(jQuery);

function initialFancyBox(){typeof $.fancybox=="function"&&$(".fancybox").fancybox({titlePosition:"inside",onStart:function(e,t,n){$.fancybox.currentOptions=n}})}NETANGELS.util.htmlspecialchars=function(e){return e.replace("&","&amp;").replace('"',"&quot;").replace("'","&amp;").replace("<","&lt;").replace(">","&gt;")},NETANGELS.util.shortingWord=function(e){return e.length>13&&(e=e.slice(0,10)+"-"+e.slice(-2)),e},NETANGELS.util.shortingString=function(e){var t=e.split(" ");return t.map(NETANGELS.util.shortingWord).join(" ")},NETANGELS.util.filesizeformat=function(e){try{e=parseFloat(e)}catch(t){return"\u043e\u0448\u0438\u0431\u043a\u0430!"}return e<1024?e+" \u0431\u0430\u0439\u0442":e<1048576?(e/1024).toFixed(2)+" kb":e<1073741824?(e/1048576).toFixed(2)+" Mb":(e/1073741824).toFixed(2)+" Gb"},$(function(){initialFancyBox()}),NETANGELS.util.translit=function(e){var t,n="",r={"\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0401":"Yo","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"Y","\u041a":"K","\u041b":"L","\u041c":"M","\u041d":"N","\u041e":"O","\u041f":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"Ts","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042a":"","\u042b":"Y","\u042c":"","\u042d":"E","\u042e":"Yu","\u042f":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0451":"yo","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"y","\u043a":"k","\u043b":"l","\u043c":"m","\u043d":"n","\u043e":"o","\u043f":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"kh","\u0446":"ts","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044a":"","\u044b":"y","\u044c":"","\u044d":"e","\u044e":"yu","\u044f":"ya"};for(t=0;t<e.length;t++)r[e.charAt(t)]!==undefined?n+=r[e.charAt(t)]:n+=e.charAt(t);return n},NETANGELS.util.getparams=function(){var e,t={},n=/\+/g,r=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},s=window.location.search.substring(1);while(e=r.exec(s))t[i(e[1])]=i(e[2]);return t},NETANGELS.util.urlParamsReplacer={replace:function(e,t,n){n=n||/\{\w+\}/g;var r=e.match(n);if(r){var i=e;for(var s=0;s<r.length;s++){var o=r[s].substr(1,r[s].length-2);i=i.replace(r[s],t[o])}return i}return e}};
